function GetComments(n){$("#fixed").show();var t=$("#hiddenType").val();$.ajax({type:"POST",url:"comment/commentsjson.ashx",data:{tid:$("#hiddenTid").val(),type:t,page:n},dataType:"text",timeout:5e3,success:function(data){var review=eval("("+data+")"),result=TrimPath.processDOMTemplate("_mycomments_",review),myTemplateObj=TrimPath.parseDOMTemplate("_mycomments_"),result=myTemplateObj.process(review),ReviewCount;$("#MyComments").html(result),$("#fixed").hide(),ReviewCount=review.Count[0].ReviewCount,$("#span_reviewcount,#div_reviewcount").html(ReviewCount),ReviewCount==0&&(t==3?$("#MyComments").html('<div style="color:red;text-align:center;">还没有你的评论，赶紧来吧<\/div>'):$("#MyComments").html('<div style="color:red;text-align:center;">还没有评论，赶快来抢沙发吧<\/div>')),getPager(n,ReviewCount),GoTop()},error:function(){}})}function GetMyComments(n){$("#fixed").show(),$.ajax({type:"POST",url:"comment/mycommentsjson.ashx",data:{type:$("#hiddenType").val(),page:n},dataType:"text",timeout:5e3,success:function(t){var i=t.split("wwgmydrivers||");i.length==2&&($("#MyComments").html(i[0]),$("#fixed").hide(),getMyPager(n,i[1])),GoTop()},error:function(){}})}function PostComment(n){var t="",i=$("#txtContent"+n).val(),r=$("#hiddenTid").val();if(i.length<5){ShowAjaxTip("CommentsTip"+n,"评论内容不得少于5个字符！","AjaxTipWarning"),$("#txtContent"+n).focus();return}$.ajax({type:"POST",url:"comment/post.ashx",data:{cid:1,tid:r,rid:n,content:Replace(i)},success:function(i){switch(i){case"0":t="您要评论的主题不存在",ShowAjaxTip("CommentsTip"+n,t,"AjaxTipWarning");break;case"1":t="验证码不正确",ShowAjaxTip("CommentsTip"+n,t,"AjaxTipWarning");break;case"2":t="15秒内不允许再次评论",ShowAjaxTip("CommentsTip"+n,t,"AjaxTipWarning");break;case"4":t="评论内容不得少于 5 字多于 1000 字",ShowAjaxTip("CommentsTip"+n,t,"AjaxTipWarning");break;case"5":t="发送评论成功.",ShowAjaxTip("CommentsTip"+n,t,"AjaxTipComplete"),$("#txtContent"+n).val(""),GetComments(1);break;case"6":t="您的评论中含有被系统禁止的内容，请修改后再发表",ShowAjaxTip("CommentsTip"+n,t,"AjaxTipWarning");break;case"7":t="页面超时请刷新页面后再发表",ShowAjaxTip("CommentsTip"+n,t,"AjaxTipWarning");break;case"9":t="暂时不允许发表评论",ShowAjaxTip("CommentsTip"+n,t,"AjaxTipWarning");break;case"10":t="您的IP地址被屏蔽，请联系管理员",ShowAjaxTip("CommentsTip"+n,t,"AjaxTipWarning");break;case"12":t="找不到验证码",ShowAjaxTip("CommentsTip"+n,t,"AjaxTipWarning");break;case"13":t="60天以前的新闻评论被禁止,感谢您对本网站的支持",ShowAjaxTip("CommentsTip"+n,t,"AjaxTipWarning");break;case"14":t="此新闻不允许发表评论,感谢您对本网站的支持",ShowAjaxTip("CommentsTip"+n,t,"AjaxTipWarning");break;case"15":t="此新闻不允许匿名用户发表评论,感谢您对本网站的支持",ShowAjaxTip("CommentsTip"+n,t,"AjaxTipWarning");break;case"16":t="此新闻的评论内容不允许重复,感谢您对本网站的支持",ShowAjaxTip("CommentsTip"+n,t,"AjaxTipWarning");break;default:t="未知错误",ShowAjaxTip("CommentsTip"+n,t,"AjaxTipWarning")}},complete:function(){},error:function(){ShowAjaxTip("CommentsTip"+n,"出错误了，请稍后重试！","AjaxTipWarning")}})}function GetRelatedNews(n){$.ajax({type:"GET",url:"relatednews.aspx",data:{q:n},dataType:"text",timeout:5e3,success:function(data){var news=eval("("+data+")"),str,i;if(news.length>0){for(str="<span>相关新闻<\/span><ul>",i=0;i<news.length;i++)i<6&&(str+='<li><a href="newsview.aspx@id='+news[i].id+'">'+news[i].title+"<\/a><\/li>");str+='<div style="clear:both;"><\/div><\/ul>',$("#div_relatednews").html(str)}},error:function(){}})}function changetab(n,t){if($("#a_comments1").removeClass("currtab"),$("#a_comments2").removeClass("currtab"),$("#a_comments3").removeClass("currtab"),$("#a_comments"+n).addClass("currtab"),$("#hiddenType").val(n),$("#a_allreviews").attr("href","comment/review.aspx@tid="+t+"&type="+n),n==3){$("#div_seeall").html("查看所有我的评论");var i=getCookie("mydrivers_userid"),r=getCookie("mydrivers_usernumid");i!=null&&i!=""?$("#a_allreviews").attr("href","comment/myreview.aspx"):window.location.href="login.aspx@ReturnUrl="+window.location.href+"&t=2"}else $("#div_seeall").html('查看所有<span id="span_reviewcount">0<\/span>条评论');GetComments(1)}function seeallreviews(n){var t=$("#hiddenType").val(),i=getCookie("mydrivers_userid"),r="comment/review.aspx@tid="+n+"&type="+t;t==3&&(r=i==null||i==""?"/login.aspx?ReturnUrl="+window.location.href+"&t=2":"comment/myreview.aspx"),window.location.href=r}function weibologin(n,t){n=="qq"?window.location.href="../passport.mydrivers.com/qq/qqlogin.aspx@reurl="+t:n=="sina"&&(window.location.href="../passport.mydrivers.com/weibo/sinaweibo.aspx@reurl="+t)}function sndReq(n,t,i,r){i=="support"?$("#s_"+t).html("支持["+(parseInt(r)+1)+"]"):$("#o_"+t).html("反对["+(parseInt(r)+1)+"]");var u=getCookie("Vote"+n+t);u==null&&$.ajax({type:"POST",url:"comment/vote.ashx",data:{act:i,tid:n,rid:t},dataType:"text",timeout:5e3,success:function(){setCookie("Vote"+n+t,i)},error:function(){}})}function userReport(n,t){($("#span_jubao_"+n).html("已举报"),getCookie("report_"+n)!="yes")&&$.ajax({type:"POST",url:"comment/usereport.ashx",data:{ID:n,Tid:t},dataType:"text",timeout:5e3,success:function(){},error:function(){}})}function ShowReply(n){var t,i,r;if($("#div_reply_"+n).html().length>0){$("#div_reply_"+n).html("");return}t="",t+='<div style="padding-top: 5px;">',t+='\t<div class="plun_input">',t+="\t\t<span>发表评论：<\/span>",i=getCookie("mydrivers_userid"),r=getCookie("mydrivers_usernumid"),i!=null&&i!=""?(t+='<div onclick="logout()" class="button_style3" style="border-right: 0;">退出<\/div>',t+='<div class="loguser">你好，'+decodeURI(i)+"<\/div>"):(t+='<div onclick="gourl(\'reg\')" class="button_style3" style="border-right: 0;">注册<\/div>',t+='<div onclick="gourl(\'login\')" class="button_style3">登录<\/div>'),t+="\t<\/div>",t+='\t<div class="plunxx_center1">',t+='\t\t<textarea name="txtContent'+n+'" id="txtContent'+n+'" cols="45" rows="5" class="plun_login_textarea"><\/textarea>',t+="\t<\/div>",t+='\t<div class="plun_bt_tj_button"><div style=\'float:left;width:200px;\'><div id="CommentsTip'+n+'" class="AjaxTipWarning"><\/div><\/div>',t+='\t\t<input type="button" name="btnlogin" id="btnlogin" value="发表评论" onclick="PostComment('+n+')" class="button_style1">',t+="\t<\/div>",t+="<\/div>",$("#div_reply_"+n).html(t)}function shoucang(n,t){var i=getCookie("mydrivers_userid");i!=null&&i!=""?$.ajax({type:"POST",url:"/shoucang.ashx",data:{tid:n,title:t},dataType:"text",timeout:5e3,success:function(n){n=="收藏成功"?($("#div_shoucang").removeAttr("class").addClass("sc2"),alert("收藏成功")):n=="取消成功"&&($("#div_shoucang").removeAttr("class").addClass("sc"),alert("取消成功"))},error:function(){}}):window.location.href="/login.aspx?ReturnUrl="+window.location.href+"&t=1"}function ShowAjaxTip(n,t,i){$("#"+n).html('<div style="float: right"><img src="../11.mydrivers.com/comments/images/v20130509/'+i+'.gif" style="margin: 7px 7px;cursor:pointer;" onclick="HideAxajTip(this);"><\/div><div>'+t+"<div>").removeAttr("class").addClass(i).show()}function HideAxajTip(n){n.parentNode.parentNode.style.display="none"}function gohome(){window.location.href="default.htm"}function GoTop(){window.scrollTo(0,0)}function Replace(n){return re=/%/g,n=n.replace(re,"％"),re=/\+/g,n.replace(re,"＋")}function logout(){var n="../passport.mydrivers.com/logout.aspx@ReturnUrl="+window.location.href;parent.location=n}function gourl(n){var t="";n=="login"?t="login.aspx@ReturnUrl="+window.location.href:n=="reg"&&(t="reg.aspx@ReturnUrl="+window.location.href),parent.location=t}function userslogin(){var n=$("#txtUserName").val();if($("#txtUserName").val()=="")return alert("用户名不能为空"),$("#txtUserName").focus(),!1;if($("#txtPwd").val()=="")return alert("密码不能为空"),$("#txtPwd").focus(),!1;document.charset="gb2312",userlogin.action="../passport.mydrivers.com/comments/check_login.aspx@ReturnUrl="+$("#hiddenReturnUrl").val()}function NewsAppADClose(){$(".newsappad").hide(),setCookie2("newsappad","1")}function getNewsAppAD(){var n=navigator.userAgent.toLowerCase();n.indexOf("ipad")>-1||n.indexOf("iphone")>-1||n.indexOf("ipod")>-1?getCookie("newsappad")==null&&$("#div_iosad").show():n.indexOf("Windows Phone")>-1||getCookie("newsappad")==null&&$("#div_androidad").show()}function getCookie(n){var t;if(n&&(t=document.cookie.indexOf(n+"="),t!=-1)){var i=document.cookie.substring(t+n.length+1,document.cookie.length),r=i.split(";");return r[0]}}function setCookie(n,t){var i=new Date;i.setTime(i.getTime()+2592e6),document.cookie=n+"="+escape(t)+";expires="+i.toGMTString()}function setCookie2(n,t){var i=new Date;i.setTime(i.getTime()+18e5),document.cookie=n+"="+escape(t)+";expires="+i.toGMTString()}function setFontSize(n){n==22?($("#content").addClass("big").removeClass("small"),$("#contentFontp18").html("<a id='contentFont18' href='javascript:setFontSize(18);' class='f-small f-click'>A<\/a>"),$("#contentFontp18").addClass("f-small"),$("#contentFontp22").html("<a id='contentFont22'>A<\/a>"),$("#contentFontp22").addClass("f-big f-gray"),setCookie("fontsize",22)):($("#content").addClass("small").removeClass("big"),$("#contentFontp22").html("<a id='contentFont22' href='javascript:setFontSize(22);' class='f-click'>A<\/a>"),$("#contentFontp22").addClass("f-big"),$("#contentFontp18").html("<a id='contentFont18' class='f-small'>A<\/a>"),$("#contentFontp18").addClass("f-small f-gray"),setCookie("fontsize",18))}function StringBuffer(){this._strings_=[]}function getPager(n,t){var i=new StringBuffer,h="",u=5,e=20,o,s,f,r;for(pagecount=t%e!=0?parseInt(t/e)+1:parseInt(t/e),n<1&&(n=1),pagecount<1&&(pagecount=1),n>pagecount&&(n=pagecount),o=n-1,s=n+1,o<1?i.append(' <span class="sinfo">上一页<\/span>'):i.append(' <a href="javascript:GetComments('+o+')">上一页<\/a>'),f=n%u==0?n-(u-1):n-parseInt(n%u)+1,f>u&&i.append('<a href="javascript:GetComments('+(f-1)+')">...<\/a>'),r=f;r<f+u;r++){if(r>pagecount)break;r==n?i.append(' <span class="pagecurr" title="Page '+r+'">'+r+"<\/span>"):i.append(' <a href="javascript:GetComments('+r+')">'+r+"<\/a>")}pagecount>=n+u&&i.append('<a href="javascript:GetComments('+(f+u)+')">...<\/a>'),s>pagecount?i.append(' <span class="sinfo">下一页<\/span>'):i.append(' <a href="javascript:GetComments('+s+')">下一页<\/a>'),i.append("<br />"),h=i.toString(),pagecount>1?$(".postpage").html(h).show():$(".postpage").hide()}function getMyPager(n,t){var i=new StringBuffer,h="",u=5,e=20,o,s,f,r;for(pagecount=t%e!=0?parseInt(t/e)+1:parseInt(t/e),n<1&&(n=1),pagecount<1&&(pagecount=1),n>pagecount&&(n=pagecount),o=n-1,s=n+1,o<1?i.append(' <span class="sinfo">上一页<\/span>'):i.append(' <a href="javascript:GetMyComments('+o+')">上一页<\/a>'),f=n%u==0?n-(u-1):n-parseInt(n%u)+1,f>u&&i.append('<a href="javascript:GetMyComments('+(f-1)+')">...<\/a>'),r=f;r<f+u;r++){if(r>pagecount)break;r==n?i.append(' <span class="pagecurr" title="Page '+r+'">'+r+"<\/span>"):i.append(' <a href="javascript:GetMyComments('+r+')">'+r+"<\/a>")}pagecount>=n+u&&i.append('<a href="javascript:GetMyComments('+(f+u)+')">...<\/a>'),s>pagecount?i.append(' <span class="sinfo">下一页<\/span>'):i.append(' <a href="javascript:GetMyComments('+s+')">下一页<\/a>'),i.append("<br />"),h=i.toString(),pagecount>1?$(".postpage").html(h).show():$(".postpage").hide()}StringBuffer.prototype.append=function(n){this._strings_.push(n)},StringBuffer.prototype.toString=function(){return this._strings_.join("")};
//@ sourceMappingURL=common.min.js.map